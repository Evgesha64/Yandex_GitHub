
# Проект: Обучение с учителем — качество модели

## Описание проекта

Интернет-магазин «В один клик» продаёт широкий ассортимент товаров и столкнулся со снижением покупательской активности постоянных клиентов. Привлечение новых покупателей становится менее эффективным, поэтому основной бизнес-задачей является **удержание существующих клиентов** за счёт персонализированных предложений.

Руководство компании принимает решения исключительно на основе данных, поэтому в рамках проекта требуется разработать и оценить модель машинного обучения, способную предсказать снижение покупательской активности клиентов и помочь бизнесу выделить проблемные сегменты.

Проект реализован в формате обучения с учителем и ориентирован на практическое применение результатов в маркетинге и управлении клиентскими отношениями.

## Постановка задачи

Цель проекта — построить модель бинарной классификации, которая:

* прогнозирует вероятность снижения покупательской активности клиента в ближайшие три месяца;
* позволяет выявить клиентов с высоким риском снижения активности;
* может быть использована совместно с данными о прибыльности для сегментации клиентов и принятия бизнес-решений.

Целевой признак:

* **Покупательская активность**
  Классы: «снизилась» / «прежний уровень».

В качестве признаков используются данные из нескольких источников, описывающих:

* маркетинговые коммуникации с клиентом;
* продуктовое поведение;
* финансовое поведение;
* поведение клиента на сайте.

## Используемые данные

В проекте применялись следующие таблицы:

* `market_file.csv` — данные о клиентах, коммуникациях, продуктовом и поведенческом профиле;
* `market_money.csv` — выручка клиентов по периодам;
* `market_time.csv` — время, проведённое клиентами на сайте;
* `money.csv` — данные о среднемесячной прибыли клиентов (использовались на этапе сегментации).

Перед моделированием данные были очищены, проанализированы и объединены в единую таблицу.

## Подход к решению

Работа над проектом включала следующие этапы:

1. Загрузка и первичный анализ данных.
2. Предобработка данных (работа с пропусками, выбросами, типами данных).
3. Исследовательский анализ данных (EDA).
4. Объединение таблиц и формирование финального датасета.
5. Корреляционный анализ и устранение мультиколлинеарности.
6. Построение пайплайнов с использованием `ColumnTransformer`.
7. Обучение и сравнение нескольких моделей машинного обучения.
8. Выбор лучшей модели по заданной метрике.
9. Анализ важности признаков с помощью SHAP.
10. Сегментация клиентов и анализ бизнес-метрик.

## Используемые модели

В рамках проекта были обучены и сравнены следующие модели:

* **Logistic Regression** — базовая интерпретируемая модель;
* **KNeighborsClassifier** — модель на основе расстояний между клиентами;
* **DecisionTreeClassifier** — модель для выявления нелинейных зависимостей;
* **Support Vector Classifier (SVC)** — модель для построения оптимальной разделяющей границы.

Для моделей использовались:

* масштабирование числовых признаков (`StandardScaler`, `MinMaxScaler`);
* кодирование категориальных признаков (`OneHotEncoder`, порядковое кодирование);
* подбор гиперпараметров с использованием кросс-валидации.

В качестве основной метрики качества была выбрана метрика, отражающая баланс между точностью и полнотой выявления клиентов с риском снижения активности (F1-score, ROC-AUC).

## Итоговые выводы

### Результаты моделирования

По результатам сравнения моделей лучшей оказалась модель **Support Vector Classifier (SVC)**.

Качество модели:

* **F1-score:** 0.844
* **ROC-AUC:** 0.899
* **Точность предсказания (Accuracy):** 89.2%

Модель демонстрирует высокую способность выявлять клиентов с риском снижения покупательской активности и может быть использована в практических бизнес-задачах.

### Анализ важности признаков

Для интерпретации модели был применён метод SHAP. Анализ показал, что ключевыми факторами снижения активности являются поведенческие характеристики клиентов на сайте.

Топ-5 наиболее важных признаков:

1. **Страниц_за_визит** — 0.0971
2. **Время_предыдущий_месяц** — 0.0397
3. **Время_текущий_месяц** — 0.0362
4. **Средний_просмотр_категорий_за_визит** — 0.0143
5. **Популярная_категория** — 0.0138

Результаты указывают на то, что глубина и интенсивность взаимодействия клиента с сайтом напрямую связаны с изменением его покупательской активности.

### Сегментация клиентов

На основе вероятностей, предсказанных моделью, и данных о прибыльности была выполнена сегментация клиентов.

Результаты сегментации:

* **Всего сегментов:** 9
* **Общее количество клиентов:** 1300
* **Клиенты с критическим риском снижения активности:** 157
* **Доля проблемных клиентов:** 12.1%

Выделенные сегменты могут использоваться для разработки персонализированных маркетинговых стратегий.

### Бизнес-метрики и практическая ценность

Финансовый анализ показал, что клиенты с высоким риском снижения активности формируют значимую часть прибыли:

* **Общая прибыль:** 5195.62
* **Прибыль от проблемных клиентов:** 621.49
* **Доля прибыли от проблемных клиентов:** 12.0%

Это подтверждает, что работа с проблемными сегментами способна существенно повлиять на удержание выручки и повышение эффективности бизнеса.

## Общий вывод

В рамках проекта была успешно разработана и оценена модель машинного обучения, позволяющая прогнозировать снижение покупательской активности клиентов интернет-магазина. Полученные результаты демонстрируют высокое качество предсказаний и практическую применимость модели для сегментации клиентов и принятия управленческих решений.

Решение может быть использовано как аналитический инструмент для повышения лояльности клиентов и оптимизации маркетинговых стратегий компании.
